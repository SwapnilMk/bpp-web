import{aA as M,r as l,u as q,aN as y,aO as v,aP as E,j as e,aB as W,aC as D,aD as H,aE as U,I as h,aQ as Y,t as _,B as x,E as N,i as S,aI as J,aJ as Q,aR as p,aS as T,aT as C,x as n,aU as G,c as K}from"./index-CCIEx66s.js";const X=E({identifier:p().nonempty("Email or phone number is required").refine(r=>{const c=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,w=/^\d{10}$/;return c.test(r)||w.test(r)},{message:"Please enter a valid email address or 10-digit phone number"})}),ee=E({otp:p().length(4,"OTP must be 4 digits"),newPassword:p().min(1,"Password is required"),confirmPassword:p().min(1,"Confirm Password is required"),showPassword:T().default(!1),showConfirmPassword:T().default(!1)}).refine(r=>r.newPassword===r.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]}),se=()=>{const r=M(),[c,w]=l.useState(1),[o,R]=l.useState({type:"",value:""}),[f,P]=l.useState(300),[z,j]=l.useState(!1),[d,i]=l.useState(!1),O=q(),m=y({resolver:v(X),defaultValues:{identifier:""}}),s=y({resolver:v(ee),defaultValues:{otp:"",newPassword:"",confirmPassword:"",showPassword:!1,showConfirmPassword:!1}}),{watch:k}=m,g=k("identifier"),b=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,A=/^\d{10}$/,I=b.test(g),F=A.test(g);l.useEffect(()=>{let t;return c===2&&f>0?t=setInterval(()=>{P(a=>a-1)},1e3):f===0&&j(!0),()=>{t&&clearInterval(t)}},[c,f]);const L=t=>{const a=Math.floor(t/60),u=t%60;return`${a}:${u.toString().padStart(2,"0")}`},$=async t=>{try{i(!0);const a=t.identifier.trim(),u=b.test(a),V=u?{email:a}:{phone:`+91${a}`};await r(C(V)).unwrap(),R({type:u?"email":"phone",value:a}),w(2),P(300),j(!1),n.success("OTP sent successfully")}catch(a){a instanceof Error?n.error(a.message):n.error("Failed to send OTP. Please try again.")}finally{i(!1)}},Z=async()=>{try{i(!0);const t=o.type==="email"?{email:o.value}:{phone:`+91${o.value}`};await r(C(t)).unwrap(),P(300),j(!1),n.success("OTP resent successfully")}catch(t){t instanceof Error?n.error(t.message):n.error("Failed to resend OTP. Please try again.")}finally{i(!1)}},B=async t=>{try{i(!0);const a={otp:t.otp,newPassword:t.newPassword,[o.type]:o.type==="email"?o.value:`+91${o.value}`};await r(G(a)).unwrap(),n.success("Password reset successfully"),setTimeout(()=>O({to:"/sign-in"}),3e3)}catch(a){a instanceof Error?n.error(a.message):n.error("Failed to reset password. Please try again.")}finally{i(!1)}};return e.jsx("section",{className:"flex min-h-screen items-start justify-center bg-background px-4 pt-2 sm:items-center sm:p-8 sm:py-6 md:p-10",children:e.jsxs("div",{className:"w-full max-w-xl",children:[e.jsxs(W,{className:"border-0 shadow-none sm:border sm:shadow-md",children:[e.jsx(D,{className:"flex flex-col items-center justify-center px-2 pt-2 sm:px-4 sm:pt-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("img",{src:H,alt:"BPP Logo",className:"w-[90px] rounded-lg object-contain sm:w-[110px]"}),e.jsx("h2",{className:"font-Inter text-md font-black text-[#2563ec] sm:text-lg",children:"WELCOME TO"}),e.jsx("h2",{className:"font-Inter text-xl font-black text-[#e85a32] sm:text-2xl",children:"BHARATIYA POPULAR PARTY"})]})}),e.jsx(U,{className:"px-2 sm:px-6",children:c===1?e.jsxs("form",{onSubmit:m.handleSubmit($),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Email/Phone number"}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{type:"text",placeholder:"Enter email or phone",autoComplete:"username",...m.register("identifier")}),e.jsxs("div",{className:"pointer-events-none absolute inset-y-0 end-0 flex items-center justify-center pe-3 text-muted-foreground/80 peer-disabled:opacity-50",children:[I&&e.jsx(Y,{size:16,strokeWidth:2,"aria-hidden":"true"}),F&&e.jsx(_,{size:16,strokeWidth:2,"aria-hidden":"true"})]})]}),m.formState.errors.identifier&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:m.formState.errors.identifier.message})]}),e.jsx(x,{type:"submit",size:"sm",className:"w-full",disabled:d,children:d?"Sending OTP...":"Send OTP"})]}):e.jsxs("form",{onSubmit:s.handleSubmit(B),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:o.type==="email"?"Email":"Phone"}),e.jsx(h,{value:o.value,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"OTP"}),e.jsx(h,{placeholder:"Enter 4-digit OTP",maxLength:4,type:"text",inputMode:"numeric",...s.register("otp")}),s.formState.errors.otp&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.formState.errors.otp.message}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:["Time remaining: ",L(f)]}),z&&e.jsx(x,{type:"button",variant:"link",className:"h-auto p-0 text-blue-600",onClick:Z,disabled:d,children:"Resend OTP"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{type:s.watch("showPassword")?"text":"password",placeholder:"Enter new password",...s.register("newPassword")}),e.jsx(x,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>s.setValue("showPassword",!s.watch("showPassword")),children:s.watch("showPassword")?e.jsx(N,{size:16}):e.jsx(S,{size:16})})]}),s.formState.errors.newPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.formState.errors.newPassword.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{type:s.watch("showConfirmPassword")?"text":"password",placeholder:"Confirm new password",...s.register("confirmPassword")}),e.jsx(x,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>s.setValue("showConfirmPassword",!s.watch("showConfirmPassword")),children:s.watch("showConfirmPassword")?e.jsx(N,{size:16}):e.jsx(S,{size:16})})]}),s.formState.errors.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.formState.errors.confirmPassword.message})]})]}),e.jsx(x,{type:"submit",size:"sm",className:"w-full",disabled:d,children:d?"Resetting Password...":"Reset Password"})]})})]}),e.jsxs("div",{className:"mt-3 flex justify-center gap-1 text-sm",children:[e.jsx("p",{children:"Remember your password?"}),e.jsx(J,{to:"/sign-in",className:"font-semibold underline",children:"Log in"})]}),e.jsx(Q,{})]})})},ae=K("/(auth)/forgot-password")({component:se});export{ae as Route};
