import{cq as F,r as g,aN as S,aO as A,aP as f,j as e,bi as q,bj as a,bk as t,bl as n,bm as i,I as o,cI as v,bn as c,B as N,x,aR as l,c as I}from"./index-54a_Xl81.js";import{p as L}from"./profile.service-Bvp-ZGdQ.js";import{C}from"./content-section-CbZYS7HH.js";const E=f({address:f({line1:l().min(5,{message:"Address Line 1 is required."}),line2:l().optional(),cityOrVillage:l().min(2,{message:"City or village is required."}),district:l().min(2,{message:"District is required."}),state:l().min(2,{message:"State is required."}),pincode:l().regex(/^\d{6}$/,{message:"Pincode must be 6 digits."})})});function O(){const d=F(s=>s.user.user),[j,m]=g.useState(!0),r=S({resolver:A(E),defaultValues:{address:{line1:"",line2:"",cityOrVillage:"",district:"",state:"",pincode:""}},mode:"onChange"});g.useEffect(()=>{d&&d.address&&r.reset({address:d.address}),m(!1)},[d,r]);const y=async s=>{var p,u;try{m(!0),JSON.stringify(s.address)!==JSON.stringify(d==null?void 0:d.address)?(await L.requestUpdate({updates:{address:s.address},type:"SENSITIVE"})).data.success&&x.success("Address update request sent for approval"):x.info("No changes detected in address")}catch(h){const b=h;x.error(((u=(p=b.response)==null?void 0:p.data)==null?void 0:u.message)||"Failed to update address")}finally{m(!1)}};return e.jsx(e.Fragment,{children:j?e.jsx("div",{className:"text-center text-muted-foreground",children:"Loading address details..."}):e.jsx(q,{...r,children:e.jsxs("form",{id:"address-form",onSubmit:r.handleSubmit(y),className:"space-y-8",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(a,{control:r.control,name:"address.line1",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"Address Line 1"}),e.jsx(i,{children:e.jsx(o,{...s})}),e.jsx(v,{children:"Address changes require admin approval and can only be updated every 3 months"}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"address.line2",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"Address Line 2"}),e.jsx(i,{children:e.jsx(o,{...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"address.cityOrVillage",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"City/Village"}),e.jsx(i,{children:e.jsx(o,{...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"address.district",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"District"}),e.jsx(i,{children:e.jsx(o,{...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"address.state",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"State"}),e.jsx(i,{children:e.jsx(o,{...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"address.pincode",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"Pincode"}),e.jsx(i,{children:e.jsx(o,{...s})}),e.jsx(c,{})]})})]}),e.jsx(N,{type:"submit",disabled:j,children:"Update address"})]})})})}function V(){return e.jsx(C,{title:"Address Information",desc:"Update your residential address details.",children:e.jsx(O,{})})}const P=I("/dashboard/profile/address")({component:V});export{P as Route};
