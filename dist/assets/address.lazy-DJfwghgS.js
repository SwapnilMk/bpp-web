import{cv as F,r as g,aN as S,aO as A,aP as f,j as e,bn as v,bo as a,bp as t,bq as n,br as i,I as o,cJ as q,bs as c,B as N,x as m,aR as l,c as L}from"./index-CCIEx66s.js";import{p as C}from"./profile.service-B8MYvO4A.js";import{C as E}from"./content-section-CTp5cUny.js";const I=f({address:f({line1:l().min(5,{message:"Address Line 1 is required."}),line2:l().optional(),cityOrVillage:l().min(2,{message:"City or village is required."}),district:l().min(2,{message:"District is required."}),state:l().min(2,{message:"State is required."}),pincode:l().regex(/^\d{6}$/,{message:"Pincode must be 6 digits."})})});function O(){const d=F(s=>s.user.user),[j,x]=g.useState(!0),r=S({resolver:A(I),defaultValues:{address:{line1:"",line2:"",cityOrVillage:"",district:"",state:"",pincode:""}},mode:"onChange"});g.useEffect(()=>{d&&d.address&&r.reset({address:d.address}),x(!1)},[d,r]);const y=async s=>{var p,u;try{x(!0),JSON.stringify(s.address)!==JSON.stringify(d==null?void 0:d.address)?(await C.requestUpdate({updates:{address:s.address},type:"SENSITIVE"})).data.success&&m.success("Address update request sent for approval"):m.info("No changes detected in address")}catch(h){const b=h;m.error(((u=(p=b.response)==null?void 0:p.data)==null?void 0:u.message)||"Failed to update address")}finally{x(!1)}};return e.jsx(e.Fragment,{children:j?e.jsx("div",{className:"text-center text-muted-foreground",children:"Loading address details..."}):e.jsx(v,{...r,children:e.jsxs("form",{id:"address-form",onSubmit:r.handleSubmit(y),className:"space-y-8",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(a,{control:r.control,name:"address.line1",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"Address Line 1"}),e.jsx(i,{children:e.jsx(o,{...s})}),e.jsx(q,{children:"Address changes require admin approval and can only be updated every 3 months"}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"address.line2",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"Address Line 2"}),e.jsx(i,{children:e.jsx(o,{...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"address.cityOrVillage",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"City/Village"}),e.jsx(i,{children:e.jsx(o,{...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"address.district",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"District"}),e.jsx(i,{children:e.jsx(o,{...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"address.state",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"State"}),e.jsx(i,{children:e.jsx(o,{...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"address.pincode",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"Pincode"}),e.jsx(i,{children:e.jsx(o,{...s})}),e.jsx(c,{})]})})]}),e.jsx(N,{type:"submit",disabled:j,children:"Update address"})]})})})}function V(){return e.jsx(E,{title:"Address Information",desc:"Update your residential address details.",children:e.jsx(O,{})})}const J=L("/dashboard/profile/address")({component:V});export{J as Route};
