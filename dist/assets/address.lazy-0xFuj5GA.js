import{c2 as S,r as g,ap as A,aq as b,ar as f,j as e,aW as q,aX as a,aY as t,aZ as n,a_ as i,I as o,ck as v,a$ as c,B as L,x as m,at as l,c as N}from"./index-BC8Au9o0.js";import{p as C}from"./profile.service-Bj9VIk5F.js";import{C as E}from"./content-section-D99diC4g.js";const I=f({address:f({line1:l().min(5,{message:"Address Line 1 is required."}),line2:l().optional(),cityOrVillage:l().min(2,{message:"City or village is required."}),district:l().min(2,{message:"District is required."}),state:l().min(2,{message:"State is required."}),pincode:l().regex(/^\d{6}$/,{message:"Pincode must be 6 digits."})})});function V(){const d=S(s=>s.user.user),[j,x]=g.useState(!0),r=A({resolver:b(I),defaultValues:{address:{line1:"",line2:"",cityOrVillage:"",district:"",state:"",pincode:""}},mode:"onChange"});g.useEffect(()=>{d&&d.address&&r.reset({address:d.address}),x(!1)},[d,r]);const y=async s=>{var p,u;try{x(!0),JSON.stringify(s.address)!==JSON.stringify(d==null?void 0:d.address)?(await C.requestUpdate({updates:{address:s.address},type:"SENSITIVE"})).data.success&&m.success("Address update request sent for approval"):m.info("No changes detected in address")}catch(h){const F=h;m.error(((u=(p=F.response)==null?void 0:p.data)==null?void 0:u.message)||"Failed to update address")}finally{x(!1)}};return e.jsx(e.Fragment,{children:j?e.jsx("div",{className:"text-center text-muted-foreground",children:"Loading address details..."}):e.jsx(q,{...r,children:e.jsxs("form",{id:"address-form",onSubmit:r.handleSubmit(y),className:"space-y-8",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(a,{control:r.control,name:"address.line1",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"Address Line 1"}),e.jsx(i,{children:e.jsx(o,{...s})}),e.jsx(v,{children:"Address changes require admin approval and can only be updated every 3 months"}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"address.line2",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"Address Line 2"}),e.jsx(i,{children:e.jsx(o,{...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"address.cityOrVillage",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"City/Village"}),e.jsx(i,{children:e.jsx(o,{...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"address.district",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"District"}),e.jsx(i,{children:e.jsx(o,{...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"address.state",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"State"}),e.jsx(i,{children:e.jsx(o,{...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"address.pincode",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"Pincode"}),e.jsx(i,{children:e.jsx(o,{...s})}),e.jsx(c,{})]})})]}),e.jsx(L,{type:"submit",disabled:j,children:"Update address"})]})})})}function O(){return e.jsx(E,{title:"Address Information",desc:"Update your residential address details.",children:e.jsx(V,{})})}const T=N("/dashboard/profile/address")({component:O});export{T as Route};
