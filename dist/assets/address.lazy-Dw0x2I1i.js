import{b as g,cx as S,j as e,dC as b}from"./react-vendor-DHXlblm3.js";import{aE as A,aC as f,a4 as x,aD as a}from"./vendor-bQrEs1q3.js";import{p as v}from"./profile.service-CoSnrHDR.js";import{aw as C,a8 as E,a9 as t,aa as i,ab as n,a6 as o,I as c,aE as q,ac as l,B as L}from"./index-2NBrDHfX.js";import{C as N}from"./content-section-BHpIwh8Y.js";import"./tanstack-vendor-CGADoYpr.js";const I=f({address:f({line1:a().min(5,{message:"Address Line 1 is required."}),line2:a().optional(),cityOrVillage:a().min(2,{message:"City or village is required."}),district:a().min(2,{message:"District is required."}),state:a().min(2,{message:"State is required."}),pincode:a().regex(/^\d{6}$/,{message:"Pincode must be 6 digits."})})});function V(){const d=C(s=>s.user.user),[j,m]=g.useState(!0),r=S({resolver:A(I),defaultValues:{address:{line1:"",line2:"",cityOrVillage:"",district:"",state:"",pincode:""}},mode:"onChange"});g.useEffect(()=>{d&&d.address&&r.reset({address:d.address}),m(!1)},[d,r]);const y=async s=>{var p,u;try{m(!0),JSON.stringify(s.address)!==JSON.stringify(d==null?void 0:d.address)?(await v.requestUpdate({updates:{address:s.address},type:"SENSITIVE"})).data.success&&x.success("Address update request sent for approval"):x.info("No changes detected in address")}catch(h){const F=h;x.error(((u=(p=F.response)==null?void 0:p.data)==null?void 0:u.message)||"Failed to update address")}finally{m(!1)}};return e.jsx(e.Fragment,{children:j?e.jsx("div",{className:"text-center text-muted-foreground",children:"Loading address details..."}):e.jsx(E,{...r,children:e.jsxs("form",{id:"address-form",onSubmit:r.handleSubmit(y),className:"space-y-8",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(t,{control:r.control,name:"address.line1",render:({field:s})=>e.jsxs(i,{children:[e.jsx(n,{children:"Address Line 1"}),e.jsx(o,{children:e.jsx(c,{...s})}),e.jsx(q,{children:"Address changes require admin approval and can only be updated every 3 months"}),e.jsx(l,{})]})}),e.jsx(t,{control:r.control,name:"address.line2",render:({field:s})=>e.jsxs(i,{children:[e.jsx(n,{children:"Address Line 2"}),e.jsx(o,{children:e.jsx(c,{...s})}),e.jsx(l,{})]})}),e.jsx(t,{control:r.control,name:"address.cityOrVillage",render:({field:s})=>e.jsxs(i,{children:[e.jsx(n,{children:"City/Village"}),e.jsx(o,{children:e.jsx(c,{...s})}),e.jsx(l,{})]})}),e.jsx(t,{control:r.control,name:"address.district",render:({field:s})=>e.jsxs(i,{children:[e.jsx(n,{children:"District"}),e.jsx(o,{children:e.jsx(c,{...s})}),e.jsx(l,{})]})}),e.jsx(t,{control:r.control,name:"address.state",render:({field:s})=>e.jsxs(i,{children:[e.jsx(n,{children:"State"}),e.jsx(o,{children:e.jsx(c,{...s})}),e.jsx(l,{})]})}),e.jsx(t,{control:r.control,name:"address.pincode",render:({field:s})=>e.jsxs(i,{children:[e.jsx(n,{children:"Pincode"}),e.jsx(o,{children:e.jsx(c,{...s})}),e.jsx(l,{})]})})]}),e.jsx(L,{type:"submit",disabled:j,children:"Update address"})]})})})}function D(){return e.jsx(N,{title:"Address Information",desc:"Update your residential address details.",children:e.jsx(V,{})})}const J=b("/dashboard/profile/address")({component:D});export{J as Route};
