import{x as F,r as g,aM as S,aN as A,aO as f,j as e,bk as v,bl as a,bm as t,bn as i,bo as n,I as o,cC as N,bp as c,B as q,y as x,aQ as l,c as C}from"./index-DEOwG95w.js";import{p as L}from"./profile.service-Cwm0Gs2G.js";import{C as O}from"./content-section-tPEaA-AE.js";const V=f({address:f({line1:l().min(5,{message:"Address Line 1 is required."}),line2:l().optional(),cityOrVillage:l().min(2,{message:"City or village is required."}),district:l().min(2,{message:"District is required."}),state:l().min(2,{message:"State is required."}),pincode:l().regex(/^\d{6}$/,{message:"Pincode must be 6 digits."})})});function E(){const{user:d}=F(),[j,m]=g.useState(!0),r=S({resolver:A(V),defaultValues:{address:(d==null?void 0:d.address)||{line1:"",line2:"",cityOrVillage:"",district:"",state:"",pincode:""}},mode:"onChange"});g.useEffect(()=>{d&&(r.reset({address:d.address||{line1:"",line2:"",cityOrVillage:"",district:"",state:"",pincode:""}}),m(!1))},[d,r]);const y=async s=>{var p,h;try{m(!0),JSON.stringify(s.address)!==JSON.stringify(d==null?void 0:d.address)?(await L.requestUpdate({updates:{address:s.address},type:"SENSITIVE"})).data.success&&x.success("Address update request sent for approval"):x.info("No changes detected in address")}catch(u){const b=u;x.error(((h=(p=b.response)==null?void 0:p.data)==null?void 0:h.message)||"Failed to update address")}finally{m(!1)}};return e.jsx(e.Fragment,{children:j?e.jsx("div",{className:"text-center text-muted-foreground",children:"Loading address details..."}):e.jsx(v,{...r,children:e.jsxs("form",{id:"address-form",onSubmit:r.handleSubmit(y),className:"space-y-8",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(a,{control:r.control,name:"address.line1",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{children:"Address Line 1"}),e.jsx(n,{children:e.jsx(o,{...s})}),e.jsx(N,{children:"Address changes require admin approval and can only be updated every 3 months"}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"address.line2",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{children:"Address Line 2"}),e.jsx(n,{children:e.jsx(o,{...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"address.cityOrVillage",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{children:"City/Village"}),e.jsx(n,{children:e.jsx(o,{...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"address.district",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{children:"District"}),e.jsx(n,{children:e.jsx(o,{...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"address.state",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{children:"State"}),e.jsx(n,{children:e.jsx(o,{...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"address.pincode",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{children:"Pincode"}),e.jsx(n,{children:e.jsx(o,{...s})}),e.jsx(c,{})]})})]}),e.jsx(q,{type:"submit",disabled:j,children:"Update address"})]})})})}function I(){return e.jsx(O,{title:"Address Information",desc:"Update your residential address details.",children:e.jsx(E,{})})}const T=C("/dashboard/profile/address")({component:I});export{T as Route};
